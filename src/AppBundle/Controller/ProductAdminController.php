<?php

namespace AppBundle\Controller;

use AppBundle\Entity\Product;
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Method;
use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Route;
use Symfony\Component\HttpFoundation\Request;

class ProductAdminController extends Controller {
  /**
   * @Route("/admin/products", name="product_list")
   */
  public function listAction(){
    $products = $this->getDoctrine()
      ->getRepository('AppBundle:Product')
      ->findAll();

    return $this->render('product/list.html.twig', [
      'products' => $products
    ]);
  }
  
  /**
   * @Route("/admin/products/new", name="product_new")
   */
  public function newAction(Request $request){
    if ($request->isMethod("POST")){
      $this->addFlash('success', 'Product created FTW!');
      
      return $this->redirectToRoute('product_list');
    }
    
    return $this->render('product/new.html.twig');  
  }
}
